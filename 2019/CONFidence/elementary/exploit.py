import angr
import claripy

START = 0x40071a
FIND  = 0x40077f
AVOID = 0x400786

flag_size =  104                                                     
flag = claripy.BVS('flag', 8 * flag_size)

p = angr.Project('elementary')
state = p.factory.blank_state(addr=START, stdin=flag)

simgr = p.factory.simulation_manager(state)
simgr.use_technique(angr.exploration_techniques.DFS())
simgr.explore(find=FIND, avoid=AVOID)

print(simgr.found[0].posix.dumps(0).decode("utf-8"))

